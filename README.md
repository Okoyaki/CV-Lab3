# CV Лабораторная работа №3

## Цель работы:
Научиться создавать простые системы классификации изображений на основе сверточных нейронных сетей.

## Задание
1. Выбрать цель для задачи классификации и датасет (собрать либо найти, например, на Kaggle)
2. Зафиксировать архитектуру сети, Loss, метрику качества
3. Натренировать (либо дотренировать сеть) на выбранном датасете
4. Оценить качество работы по выбранной метрике на валидационной выборке, определить, переобучилась ли модель
5. Сделать отчёт в виде readme на GitHub, там же должен быть выложен исходный код.

## Теоретическая база
Сверточные нейронные сети (Convolutional Neural Networks, CNN) — это разновидность искусственных нейронных сетей, специально разработанных для обработки данных, имеющих пространственную структуру, таких как изображения. Главной особенностью этих сетей является использование сверточных операций, которые позволяют выявлять важные признаки в данных, например края, текстуры или более сложные объекты, сохраняя пространственные взаимосвязи между пикселями.

Основой работы CNN являются несколько ключевых компонентов:

<b>Сверточные слои:</b> Эти слои выполняют свертку входного изображения с набором фильтров. Каждый фильтр представляет собой небольшую матрицу, которая движется по изображению и вычисляет свертку, выделяя определенные признаки, такие как линии, углы или текстуры. Благодаря этому сети не требуется обрабатывать каждый пиксель отдельно — анализируются только локальные области изображения.

<b>Функции активации:</b> После применения фильтров к данным вводится функция активации (например, ReLU), которая добавляет нелинейность и помогает сети лучше справляться с разнообразными задачами классификации.

<b>Слоев подвыборки (Pooling):</b> Эти слои уменьшают размерность данных, сохраняя наиболее важную информацию. Например, метод max pooling выбирает максимальное значение в каждой локальной области, что помогает уменьшить объем вычислений и снизить риск переобучения.

<b>Полносвязные слои:</b> В конце сети данные уплощаются и передаются в один или несколько полносвязных слоев, где происходит финальная обработка информации для выполнения задачи, например классификации объектов на изображении.

## Описание разработанной системы
В качестве датасета изображений был взят датасет 5 разных видов цветков: маргаритка, одуванчик, роза, подсолнух, тюльпан:

![alt text](https://github.com/Okoyaki/CV-Lab3/blob/3aedc1313a0523807993d5309e2cb222dab3c4f5/data/images/daisy/5673551_01d1ea993e_n.jpg)
![alt text](https://github.com/Okoyaki/CV-Lab3/blob/3aedc1313a0523807993d5309e2cb222dab3c4f5/data/images/dandelion/7355522_b66e5d3078_m.jpg)
![alt text](https://github.com/Okoyaki/CV-Lab3/blob/3aedc1313a0523807993d5309e2cb222dab3c4f5/data/images/roses/99383371_37a5ac12a3_n.jpg)
![alt text](https://github.com/Okoyaki/CV-Lab3/blob/3aedc1313a0523807993d5309e2cb222dab3c4f5/data/images/sunflowers/6953297_8576bf4ea3.jpg)
![alt text](https://github.com/Okoyaki/CV-Lab3/blob/3aedc1313a0523807993d5309e2cb222dab3c4f5/data/images/tulips/5547758_eea9edfd54_n.jpg)

Ниже приведена архитектура сверточной нейронной сети:

┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ conv2d (Conv2D)                      │ (None, 126, 126, 32)        │             896 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization                  │ (None, 126, 126, 32)        │             128 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling2d (MaxPooling2D)         │ (None, 63, 63, 32)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout (Dropout)                    │ (None, 63, 63, 32)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_1 (Conv2D)                    │ (None, 61, 61, 64)          │          18,496 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_1                │ (None, 61, 61, 64)          │             256 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling2d_1 (MaxPooling2D)       │ (None, 30, 30, 64)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 30, 30, 64)          │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ conv2d_2 (Conv2D)                    │ (None, 28, 28, 128)         │          73,856 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_2                │ (None, 28, 28, 128)         │             512 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ max_pooling2d_2 (MaxPooling2D)       │ (None, 14, 14, 128)         │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 14, 14, 128)         │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ flatten (Flatten)                    │ (None, 25088)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense (Dense)                        │ (None, 512)                 │      12,845,568 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ batch_normalization_3                │ (None, 512)                 │           2,048 │
│ (BatchNormalization)                 │                             │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (Dropout)                  │ (None, 512)                 │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_1 (Dense)                      │ (None, 5)                   │           2,565 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
